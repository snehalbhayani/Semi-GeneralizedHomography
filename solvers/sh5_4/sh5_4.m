%% We need 5 2d-2d corrs. 4 from the G1 cam. with center c1 and 1 from G2 whose center is c2
function [H] = sh5_4(q, p,c1,c2)
% M = [0 0 0 -p(3,1) * q(1,1) -p(3,1) * q(2,1) -p(3,1) * q(3,1) p(2,1) * q(2,1) p(2,1) * q(3,1) p(2,1) * q(1,1); p(3,1) * q(1,1) p(3,1) * q(2,1) p(3,1) * q(3,1) 0 0 0 -p(1,1) * q(2,1) -p(1,1) * q(3,1) -p(1,1) * q(1,1); 0 0 0 -p(3,2) * q(1,2) -p(3,2) * q(2,2) -p(3,2) * q(3,2) p(2,2) * q(2,2) p(2,2) * q(3,2) p(2,2) * q(1,2); p(3,2) * q(1,2) p(3,2) * q(2,2) p(3,2) * q(3,2) 0 0 0 -p(1,2) * q(2,2) -p(1,2) * q(3,2) -p(1,2) * q(1,2); 0 0 0 -p(3,3) * q(1,3) -p(3,3) * q(2,3) -p(3,3) * q(3,3) p(2,3) * q(2,3) p(2,3) * q(3,3) p(2,3) * q(1,3); p(3,3) * q(1,3) p(3,3) * q(2,3) p(3,3) * q(3,3) 0 0 0 -p(1,3) * q(2,3) -p(1,3) * q(3,3) -p(1,3) * q(1,3); 0 0 0 -p(3,4) * q(1,4) -p(3,4) * q(2,4) -p(3,4) * q(3,4) p(2,4) * q(2,4) p(2,4) * q(3,4) p(2,4) * q(1,4); p(3,4) * q(1,4) p(3,4) * q(2,4) p(3,4) * q(3,4) 0 0 0 -p(1,4) * q(2,4) -p(1,4) * q(3,4) -p(1,4) * q(1,4);];

M = [0 0 0 -p(3,1) * q(1,1) -p(3,1) * q(2,1) -p(3,1) * q(3,1) p(2,1) * q(1,1) p(2,1) * q(2,1) p(2,1) * q(3,1); p(3,1) * q(1,1) p(3,1) * q(2,1) p(3,1) * q(3,1) 0 0 0 -p(1,1) * q(1,1) -p(1,1) * q(2,1) -p(1,1) * q(3,1); 0 0 0 -p(3,2) * q(1,2) -p(3,2) * q(2,2) -p(3,2) * q(3,2) p(2,2) * q(1,2) p(2,2) * q(2,2) p(2,2) * q(3,2); p(3,2) * q(1,2) p(3,2) * q(2,2) p(3,2) * q(3,2) 0 0 0 -p(1,2) * q(1,2) -p(1,2) * q(2,2) -p(1,2) * q(3,2); 0 0 0 -p(3,3) * q(1,3) -p(3,3) * q(2,3) -p(3,3) * q(3,3) p(2,3) * q(1,3) p(2,3) * q(2,3) p(2,3) * q(3,3); p(3,3) * q(1,3) p(3,3) * q(2,3) p(3,3) * q(3,3) 0 0 0 -p(1,3) * q(1,3) -p(1,3) * q(2,3) -p(1,3) * q(3,3); 0 0 0 -p(3,4) * q(1,4) -p(3,4) * q(2,4) -p(3,4) * q(3,4) p(2,4) * q(1,4) p(2,4) * q(2,4) p(2,4) * q(3,4); p(3,4) * q(1,4) p(3,4) * q(2,4) p(3,4) * q(3,4) 0 0 0 -p(1,4) * q(1,4) -p(1,4) * q(2,4) -p(1,4) * q(3,4);];
[U, S, Vt] = svd(M);
h = Vt(:,9);
H = [[h(1),h(2),h(3)];[h(4),h(5),h(6)];[h(7),h(8),h(9)]];
alpha_5 = cross(p(:,5), c2-c1)./ cross(p(:,5), H*(q(:,5)));
H = sign(alpha_5(1)) * H;
end